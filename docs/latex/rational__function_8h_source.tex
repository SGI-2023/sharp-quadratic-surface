\doxysection{rational\+\_\+function.\+h}
\hypertarget{rational__function_8h_source}{}\label{rational__function_8h_source}\index{src/core/rational\_function.h@{src/core/rational\_function.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2023\ Adobe\ Research.\ All\ rights\ reserved.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ To\ view\ a\ copy\ of\ the\ license,\ visit\ LICENSE.md.}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}polyscope/curve\_network.h"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}common.h"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}interval.h"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{polynomial__function_8h}{polynomial\_function.h}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_curve_discretization_parameters}{CurveDiscretizationParameters}}}
\DoxyCodeLine{00013\ \{}
\DoxyCodeLine{00014\ \ \ \textcolor{keywordtype}{int}\ num\_samples\ =\ 5;}
\DoxyCodeLine{00015\ \ \ \textcolor{keywordtype}{int}\ num\_tangents\_per\_segment\ =\ 5;}
\DoxyCodeLine{00016\ \};}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{template}<\textcolor{keywordtype}{size\_t}\ degree,\ \textcolor{keywordtype}{size\_t}\ dimension>}
\DoxyCodeLine{00020\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_rational_function}{RationalFunction}}}
\DoxyCodeLine{00021\ \{}
\DoxyCodeLine{00022\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00023\ \ \ \textcolor{comment}{//\ ************}}
\DoxyCodeLine{00024\ \ \ \textcolor{comment}{//\ Constructors}}
\DoxyCodeLine{00025\ \ \ \textcolor{comment}{//\ ************}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{class_rational_function_abad488c849150001b6ab095e5dd6fdb8}{RationalFunction}}()}
\DoxyCodeLine{00029\ \ \ \{}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{//\ Default\ numerator\ to\ constant\ 0\ in\ R\string^n}}
\DoxyCodeLine{00031\ \ \ \ \ m\_numerator\_coeffs.setZero();}
\DoxyCodeLine{00032\ \ \ \ \ m\_denominator\_coeffs.setZero();}
\DoxyCodeLine{00033\ \ \ \ \ m\_denominator\_coeffs[0]\ =\ 1.0;}
\DoxyCodeLine{00034\ \ \ \ \ m\_domain.reset\_bounds();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ assert(is\_valid());}
\DoxyCodeLine{00037\ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{class_rational_function_a15c35eaf13167fe0e2c4f2d03918ef5d}{RationalFunction}}(}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ dimension>\&\ numerator\_coeffs)}
\DoxyCodeLine{00044\ \ \ \ \ :\ m\_numerator\_coeffs(numerator\_coeffs)}
\DoxyCodeLine{00045\ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ m\_denominator\_coeffs.setZero();}
\DoxyCodeLine{00047\ \ \ \ \ m\_denominator\_coeffs[0]\ =\ 1.0;}
\DoxyCodeLine{00048\ \ \ \ \ m\_domain.reset\_bounds();}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ assert(is\_valid());}
\DoxyCodeLine{00051\ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{class_rational_function_a12a54fe6df680120e73bfdf0cab19b03}{RationalFunction}}(}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ dimension>\&\ numerator\_coeffs,}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ 1>\&\ denominator\_coeffs)}
\DoxyCodeLine{00060\ \ \ \ \ :\ m\_numerator\_coeffs(numerator\_coeffs)}
\DoxyCodeLine{00061\ \ \ \ \ ,\ m\_denominator\_coeffs(denominator\_coeffs)}
\DoxyCodeLine{00062\ \ \ \{}
\DoxyCodeLine{00063\ \ \ \ \ m\_domain.reset\_bounds();}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ assert(is\_valid());}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00073\ \ \ \mbox{\hyperlink{class_rational_function_ac2b1e32df1be0ea3c9a80b1ba124de5e}{RationalFunction}}(}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ dimension>\&\ numerator\_coeffs,}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ 1>\&\ denominator\_coeffs,}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_interval}{Interval}}\&\ domain)}
\DoxyCodeLine{00077\ \ \ \ \ :\ m\_numerator\_coeffs(numerator\_coeffs)}
\DoxyCodeLine{00078\ \ \ \ \ ,\ m\_denominator\_coeffs(denominator\_coeffs)}
\DoxyCodeLine{00079\ \ \ \ \ ,\ m\_domain(domain)}
\DoxyCodeLine{00080\ \ \ \{}
\DoxyCodeLine{00081\ \ \ \ \ assert(is\_valid());}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ *******}}
\DoxyCodeLine{00085\ \ \ \textcolor{comment}{//\ Methods}}
\DoxyCodeLine{00086\ \ \ \textcolor{comment}{//\ *******}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00092\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_rational_function_a6c7ab7e99c478b3991cfc534bc5137bf}{get\_degree}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ degree;\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_rational_function_a3ee3fc74107bc24f2c4e5342ed429916}{get\_dimension}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ dimension;\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_aed8013bffe064d357c6e9fd645e12910}{compute\_derivative}}(}
\DoxyCodeLine{00104\ \ \ \ \ \mbox{\hyperlink{class_rational_function}{RationalFunction<2\ *\ degree,\ dimension>}}\&\ derivative)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00105\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ derivatives\ of\ the\ numerator\ and\ denominator\ polynomials}}
\DoxyCodeLine{00107\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}Taking\ derivative\ of\ rational\ function"{}});}
\DoxyCodeLine{00108\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}Numerator:\(\backslash\)n\{\}"{}},\ m\_numerator\_coeffs);}
\DoxyCodeLine{00109\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}Denominator:\(\backslash\)n\{\}"{}},\ m\_denominator\_coeffs);}
\DoxyCodeLine{00110\ \ \ \ \ Eigen::Matrix<double,\ degree,\ dimension>\ numerator\_deriv\_coeffs;}
\DoxyCodeLine{00111\ \ \ \ \ compute\_polynomial\_mapping\_derivative<degree,\ dimension>(}
\DoxyCodeLine{00112\ \ \ \ \ \ \ m\_numerator\_coeffs,\ numerator\_deriv\_coeffs);}
\DoxyCodeLine{00113\ \ \ \ \ Eigen::Matrix<double,\ degree,\ 1>\ denominator\_deriv\_coeffs;}
\DoxyCodeLine{00114\ \ \ \ \ compute\_polynomial\_mapping\_derivative<degree,\ 1>(m\_denominator\_coeffs,}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ denominator\_deriv\_coeffs);}
\DoxyCodeLine{00116\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}Numerator\ derivative:\(\backslash\)n\{\}"{}},\ numerator\_deriv\_coeffs);}
\DoxyCodeLine{00117\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}Denominator\ derivative:\(\backslash\)n\{\}"{}},\ denominator\_deriv\_coeffs);}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{comment}{//\ FIXME\ 0\ degree\ case}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ derivative\ numerator\ and\ denominator\ from\ the\ quotient\ rule}}
\DoxyCodeLine{00122\ \ \ \ \ Eigen::Matrix<double,\ 2\ *\ degree,\ dimension>\ term\_0,\ term\_1;}
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{polynomial__function_8h_aaeb94797826a19f55ed10ed50b595c94}{compute\_polynomial\_mapping\_scalar\_product}}<degree,\ degree\ -\/\ 1,\ dimension>(}
\DoxyCodeLine{00124\ \ \ \ \ \ \ m\_denominator\_coeffs,\ numerator\_deriv\_coeffs,\ term\_0);}
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{polynomial__function_8h_aaeb94797826a19f55ed10ed50b595c94}{compute\_polynomial\_mapping\_scalar\_product}}<degree\ -\/\ 1,\ degree,\ dimension>(}
\DoxyCodeLine{00126\ \ \ \ \ \ \ denominator\_deriv\_coeffs,\ m\_numerator\_coeffs,\ term\_1);}
\DoxyCodeLine{00127\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}First\ term:\(\backslash\)n\{\}"{}},\ term\_0);}
\DoxyCodeLine{00128\ \ \ \ \ spdlog::trace(\textcolor{stringliteral}{"{}Second\ term:\(\backslash\)n\{\}"{}},\ term\_1);}
\DoxyCodeLine{00129\ \ \ \ \ Eigen::Matrix<double,\ 2\ *\ degree\ +\ 1,\ dimension>\ num\_coeffs;}
\DoxyCodeLine{00130\ \ \ \ \ num\_coeffs.setZero();}
\DoxyCodeLine{00131\ \ \ \ \ num\_coeffs.block(0,\ 0,\ 2\ *\ degree,\ dimension)\ =\ term\_0\ -\/\ term\_1;}
\DoxyCodeLine{00132\ \ \ \ \ Eigen::Matrix<double,\ 2\ *\ degree\ +\ 1,\ 1>\ denom\_coeffs;}
\DoxyCodeLine{00133\ \ \ \ \ compute\_polynomial\_mapping\_product<degree,\ degree,\ 1>(}
\DoxyCodeLine{00134\ \ \ \ \ \ \ m\_denominator\_coeffs,\ m\_denominator\_coeffs,\ denom\_coeffs);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ Build\ the\ derivative}}
\DoxyCodeLine{00137\ \ \ \ \ derivative\ =\ \mbox{\hyperlink{class_rational_function}{RationalFunction<2\ *\ degree,\ dimension>}}(}
\DoxyCodeLine{00138\ \ \ \ \ \ \ num\_coeffs,\ denom\_coeffs,\ m\_domain);}
\DoxyCodeLine{00139\ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00146\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_aa85111f0e98350cccbd35377312c3f2e}{apply\_one\_form}}(\textcolor{keyword}{const}\ Eigen::Matrix<double,\ dimension,\ 1>\&\ one\_form,}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ 1>}}\ scalar\_function)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00148\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ scalar\ polynomial\ numerator\ coefficients}}
\DoxyCodeLine{00150\ \ \ \ \ Eigen::Matrix<double,\ degree\ +\ 1,\ 1>\ numerator\_coeffs;}
\DoxyCodeLine{00151\ \ \ \ \ numerator\_coeffs\ =\ m\_numerator\_coeffs\ *\ one\_form;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ Create\ a\ scalar\ rational\ function\ with\ the\ same\ domain\ and\ denominator}}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{comment}{//\ but\ the\ new\ numerator}}
\DoxyCodeLine{00155\ \ \ \ \ scalar\_function\ =\ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ 1>}}(}
\DoxyCodeLine{00156\ \ \ \ \ \ \ numerator\_coeffs,\ m\_denominator\_coeffs,\ m\_domain);}
\DoxyCodeLine{00157\ \ \ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_a45563906524c67e3868d847b52b7b96c}{split\_at\_knot}}(\textcolor{keywordtype}{double}\ knot,}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ dimension>}}\&\ lower\_segment,}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ dimension>}}\&\ upper\_segment)}
\DoxyCodeLine{00168\ \ \ \{}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{//\ Build\ lower\ segment}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordtype}{double}\ t0\ =\ m\_domain.get\_lower\_bound();}
\DoxyCodeLine{00171\ \ \ \ \ assert(t0\ <=\ knot);}
\DoxyCodeLine{00172\ \ \ \ \ \mbox{\hyperlink{class_interval}{Interval}}\ lower\_domain(t0,\ knot);}
\DoxyCodeLine{00173\ \ \ \ \ lower\_segment\ =\ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ dimension>}}(}
\DoxyCodeLine{00174\ \ \ \ \ \ \ m\_numerator\_coeffs,\ m\_denominator\_coeffs,\ lower\_domain);}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{//\ Build\ upper\ segment}}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordtype}{double}\ t1\ =\ m\_domain.get\_upper\_bound();}
\DoxyCodeLine{00178\ \ \ \ \ assert(knot\ <=\ t1);}
\DoxyCodeLine{00179\ \ \ \ \ \mbox{\hyperlink{class_interval}{Interval}}\ upper\_domain(knot,\ t1);}
\DoxyCodeLine{00180\ \ \ \ \ upper\_segment\ =\ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ dimension>}}(}
\DoxyCodeLine{00181\ \ \ \ \ \ \ m\_numerator\_coeffs,\ m\_denominator\_coeffs,\ upper\_domain);}
\DoxyCodeLine{00182\ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00188\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_a37451f8928798e178bc87cc46c1c5c48}{sample\_points}}(}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_points,}
\DoxyCodeLine{00190\ \ \ \ \ std::vector<Eigen::Matrix<double,\ 1,\ dimension>>\&\ points)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00191\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{comment}{//\ Get\ sample\ of\ the\ domain}}
\DoxyCodeLine{00193\ \ \ \ \ std::vector<double>\ t\_samples\ =\ m\_domain.sample\_points(num\_points);}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{comment}{//\ Evaluate\ the\ function\ at\ the\ sampled\ domain\ points}}
\DoxyCodeLine{00196\ \ \ \ \ points.resize(num\_points);}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_points;\ ++i)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(t\_samples[i],\ points[i]);}
\DoxyCodeLine{00199\ \ \ \ \ \}}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00205\ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ \mbox{\hyperlink{class_rational_function_a54ccf367a2303399d7ca872f1ef73571}{start\_point}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00206\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{comment}{//\ Return\ the\ default\ constructor\ point\ if\ the\ domain\ is\ not\ bounded\ below}}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_domain.is\_bounded\_below())}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Eigen::Matrix<double,\ 1,\ dimension>();}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keywordtype}{double}\ t0\ =\ m\_domain.get\_lower\_bound();}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(t0);}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00219\ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ \mbox{\hyperlink{class_rational_function_a5ab798478fd7bfdbd143b926c20a2f1d}{mid\_point}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00220\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{comment}{//\ Return\ the\ default\ constructor\ point\ if\ the\ domain\ is\ not\ bounded\ below}}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_domain.is\_bounded\_below())}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Eigen::Matrix<double,\ 1,\ dimension>();}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_domain.is\_bounded\_above())}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Eigen::Matrix<double,\ 1,\ dimension>();}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordtype}{double}\ t0\ =\ m\_domain.get\_lower\_bound();}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordtype}{double}\ t1\ =\ m\_domain.get\_upper\_bound();}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}((t0\ +\ t1)\ /\ 2.0);}
\DoxyCodeLine{00230\ \ \ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00235\ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ \mbox{\hyperlink{class_rational_function_a3e4f99d38f0fff5dbeffa665196b29af}{end\_point}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00236\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{comment}{//\ Return\ the\ default\ constructor\ point\ if\ the\ domain\ is\ not\ bounded\ below}}
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordflow}{if}\ (!m\_domain.is\_bounded\_above())}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Eigen::Matrix<double,\ 1,\ dimension>();}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordtype}{double}\ t1\ =\ m\_domain.get\_upper\_bound();}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(t1);}
\DoxyCodeLine{00243\ \ \ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00249\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(\textcolor{keywordtype}{double}\ t,\ Eigen::Matrix<double,\ 1,\ dimension>\&\ point)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00250\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00251\ \ \ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ Pt;}
\DoxyCodeLine{00252\ \ \ \ \ Eigen::Matrix<double,\ 1,\ 1>\ Qt;}
\DoxyCodeLine{00253\ \ \ \ \ evaluate\_polynomial\_mapping<degree,\ dimension>(m\_numerator\_coeffs,\ t,\ Pt);}
\DoxyCodeLine{00254\ \ \ \ \ evaluate\_polynomial\_mapping<degree,\ 1>(m\_denominator\_coeffs,\ t,\ Qt);}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ point\ =\ Pt\ /\ Qt[0];}
\DoxyCodeLine{00257\ \ \ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00263\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_af1aae7b8b64d66184d48f01748e08ae1}{evaluate\_normalized\_coordinate}}(}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keywordtype}{double}\ t,}
\DoxyCodeLine{00265\ \ \ \ \ Eigen::Matrix<double,\ 1,\ dimension>\&\ point)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00266\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ domain\ is\ bounded}}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{if}\ (!domain().is\_bounded\_below())}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{if}\ (!domain().is\_bounded\_above())}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{comment}{//\ Linearly\ interpolate\ the\ coordinate}}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordtype}{double}\ t0\ =\ domain().get\_lower\_bound();}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordtype}{double}\ t1\ =\ domain().get\_upper\_bound();}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{keywordtype}{double}\ s\ =\ interval\_lerp(0.0,\ 1.0,\ t0,\ t1,\ t);}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{comment}{//\ Evaluate\ at\ the\ given\ domain\ coordinate}}
\DoxyCodeLine{00279\ \ \ \ \ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(s,\ point);}
\DoxyCodeLine{00280\ \ \ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00285\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_rational_function_a2c079e7d758f9f0381ae0da42b5193ca}{is\_in\_domain}}(\textcolor{keywordtype}{double}\ t)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_domain.contains(t);\ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00291\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_rational_function_a5f3578f1e0d14849595f86c938ce3352}{is\_in\_domain\_interior}}(\textcolor{keywordtype}{double}\ t)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00292\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_domain.is\_in\_interior(t);}
\DoxyCodeLine{00294\ \ \ \}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00301\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_af592c153afda83fb206d5136f1b820ca}{discretize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_curve_discretization_parameters}{CurveDiscretizationParameters}}\&\ curve\_disc\_params,}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<Eigen::Matrix<double,\ 1,\ dimension>>\&\ points,}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<int>\&\ polyline)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00304\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{comment}{//\ Write\ curves}}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_samples\ =\ curve\_disc\_params.num\_samples;}
\DoxyCodeLine{00307\ \ \ \ \ \mbox{\hyperlink{class_rational_function_a37451f8928798e178bc87cc46c1c5c48}{sample\_points}}(num\_samples,\ points);}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{comment}{//\ Build\ polyline\ for\ the\ given\ curve}}
\DoxyCodeLine{00310\ \ \ \ \ polyline.resize(points.size());}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ l\ =\ 0;\ l\ <\ points.size();\ ++l)\ \{}
\DoxyCodeLine{00312\ \ \ \ \ \ \ polyline[l]\ =\ l;}
\DoxyCodeLine{00313\ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_rational_function_a260502d67735babd93a410849543be90}{add\_curve\_to\_viewer}}(}
\DoxyCodeLine{00322\ \ \ \ \ std::string\ curve\_name\ =\ \textcolor{stringliteral}{"{}rational\_function\_curve"{}})\textcolor{keyword}{\ const}}
\DoxyCodeLine{00323\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordflow}{if}\ (dimension\ !=\ 3)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ spdlog::error(\textcolor{stringliteral}{"{}Cannot\ view\ nonspatial\ curve"{}});}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00327\ \ \ \ \ \}}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{comment}{//\ Generate\ curve\ discretization}}
\DoxyCodeLine{00330\ \ \ \ \ \mbox{\hyperlink{struct_curve_discretization_parameters}{CurveDiscretizationParameters}}\ curve\_disc\_params;}
\DoxyCodeLine{00331\ \ \ \ \ std::vector<Eigen::Matrix<double,\ 1,\ dimension>>\ points;}
\DoxyCodeLine{00332\ \ \ \ \ std::vector<int>\ polyline;}
\DoxyCodeLine{00333\ \ \ \ \ \mbox{\hyperlink{class_rational_function_af592c153afda83fb206d5136f1b820ca}{discretize}}(curve\_disc\_params,\ points,\ polyline);}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{comment}{//\ Add\ curve\ mesh}}
\DoxyCodeLine{00336\ \ \ \ \ MatrixXr\ points\_mat\ =\ convert\_nested\_vector\_to\_matrix(points);}
\DoxyCodeLine{00337\ \ \ \ \ std::vector<std::vector<int>>\ polylines\ =\ \{\ polyline\ \};}
\DoxyCodeLine{00338\ \ \ \ \ std::vector<std::array<int,\ 2>>\ edges\ =}
\DoxyCodeLine{00339\ \ \ \ \ \ \ convert\_polylines\_to\_edges(polylines);}
\DoxyCodeLine{00340\ \ \ \ \ polyscope::init();}
\DoxyCodeLine{00341\ \ \ \ \ polyscope::registerCurveNetwork(curve\_name,\ points\_mat,\ edges);}
\DoxyCodeLine{00342\ \ \ \ \ polyscope::getCurveNetwork(curve\_name)-\/>setRadius(0.0025);}
\DoxyCodeLine{00343\ \ \ \}}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00354\ \ \ std::vector<Eigen::Matrix<double,\ 1,\ dimension>>\ \mbox{\hyperlink{class_rational_function_a0aba41aa657286e97f9815111e928d04}{finite\_difference\_derivative}}(}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordtype}{double}\ t,}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordtype}{double}\ h\ =\ 1e-\/3)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00357\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00358\ \ \ \ \ std::vector<Eigen::Matrix<double,\ 1,\ dimension>>\ F\_plus,\ F\_minus;}
\DoxyCodeLine{00359\ \ \ \ \ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(t\ +\ h,\ F\_plus);}
\DoxyCodeLine{00360\ \ \ \ \ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(t\ -\/\ h,\ F\_minus);}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{return}\ (F\_plus\ -\/\ F\_minus)\ /\ (2\ *\ h);}
\DoxyCodeLine{00362\ \ \ \}}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00365\ \ \ \textcolor{comment}{//\ Getters\ and\ setters}}
\DoxyCodeLine{00366\ \ \ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00367\ \ \ \textcolor{keywordtype}{void}\ set\_numerators(}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ dimension>\&\ numerator)}
\DoxyCodeLine{00369\ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ m\_numerator\_coeffs\ =\ numerator;}
\DoxyCodeLine{00371\ \ \ \}}
\DoxyCodeLine{00372\ \ \ \textcolor{keywordtype}{void}\ set\_denominator(\textcolor{keyword}{const}\ Eigen::Matrix<double,\ degree\ +\ 1,\ 1>\&\ denominator)}
\DoxyCodeLine{00373\ \ \ \{}
\DoxyCodeLine{00374\ \ \ \ \ m\_denominator\_coeffs\ =\ denominator;}
\DoxyCodeLine{00375\ \ \ \}}
\DoxyCodeLine{00376\ \ \ Eigen::Matrix<double,\ degree\ +\ 1,\ dimension>\ \textcolor{keyword}{const}\&\ get\_numerators()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00377\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_numerator\_coeffs;}
\DoxyCodeLine{00379\ \ \ \}}
\DoxyCodeLine{00380\ \ \ Eigen::Matrix<double,\ degree\ +\ 1,\ 1>\ \textcolor{keyword}{const}\&\ get\_denominator()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00381\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{keywordflow}{return}\ m\_denominator\_coeffs;}
\DoxyCodeLine{00383\ \ \ \}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \textcolor{comment}{//\ TODO:\ Fix\ direct\ exposure\ of\ domain}}
\DoxyCodeLine{00386\ \ \ \mbox{\hyperlink{class_interval}{Interval}}\&\ domain()\ \{\ \textcolor{keywordflow}{return}\ m\_domain;\ \}}
\DoxyCodeLine{00387\ \ \ \mbox{\hyperlink{class_interval}{Interval}}\ \textcolor{keyword}{const}\&\ domain()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_domain;\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \textcolor{comment}{//\ ********************}}
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{//\ Overloaded\ operators}}
\DoxyCodeLine{00391\ \ \ \textcolor{comment}{//\ ********************}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00399\ \ \ \textcolor{keyword}{template}<\textcolor{keywordtype}{size\_t}\ output\_degree,\ \textcolor{keywordtype}{size\_t}\ output\_dimension>}
\DoxyCodeLine{00400\ \ \ \textcolor{keyword}{friend}\ std::ostream\&\ \mbox{\hyperlink{class_rational_function_a93b15a6c25862fe168931ba901cf03c0}{operator<<}}(}
\DoxyCodeLine{00401\ \ \ \ \ std::ostream\&\ out,}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_rational_function}{RationalFunction<output\_degree,\ output\_dimension>}}\&\ F);}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00408\ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ \mbox{\hyperlink{class_rational_function_ad12bad3e540f001eee102fedd0e6d99a}{operator()}}(\textcolor{keywordtype}{double}\ t)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00409\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(t);}
\DoxyCodeLine{00411\ \ \ \}}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \textcolor{comment}{//\ TODO\ Implement}}
\DoxyCodeLine{00414\ \ \ \textcolor{comment}{//\ RationalFunction\ operator\ +\ (const\ RationalFunction\ \&obj)\ const;}}
\DoxyCodeLine{00415\ \ \ \textcolor{comment}{//\ RationalFunction\ operator\ -\/\ ()\ const;}}
\DoxyCodeLine{00416\ \ \ \textcolor{comment}{//\ RationalFunction\ operator\ -\/\ (const\ RationalFunction\ \&obj)\ const;}}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00419\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_conic}{Conic}};}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \ \ \textcolor{keywordtype}{bool}\ is\_valid()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00422\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_numerator\_coeffs.cols()\ ==\ 0)}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_denominator\_coeffs.size()\ ==\ 0)}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00429\ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ ******************************}}
\DoxyCodeLine{00432\ \ \ \textcolor{comment}{//\ Helper\ functions\ for\ operators}}
\DoxyCodeLine{00433\ \ \ \textcolor{comment}{//\ ******************************}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ \mbox{\hyperlink{class_rational_function_ae9dd3a492696c59250bae7617347551a}{evaluate}}(\textcolor{keywordtype}{double}\ t)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00436\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00437\ \ \ \ \ Eigen::Matrix<double,\ 1,\ dimension>\ Pt;}
\DoxyCodeLine{00438\ \ \ \ \ Eigen::Matrix<double,\ 1,\ 1>\ Qt;}
\DoxyCodeLine{00439\ \ \ \ \ evaluate\_polynomial\_mapping<degree,\ dimension>(m\_numerator\_coeffs,\ t,\ Pt);}
\DoxyCodeLine{00440\ \ \ \ \ evaluate\_polynomial\_mapping<degree,\ 1>(m\_denominator\_coeffs,\ t,\ Qt);}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordflow}{return}\ Pt\ /\ Qt[0];}
\DoxyCodeLine{00443\ \ \ \}}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ std::string\ formatted\_rational\_function()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00446\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00447\ \ \ \ \ std::stringstream\ rational\_function\_string;}
\DoxyCodeLine{00448\ \ \ \ \ rational\_function\_string\ <<\ \textcolor{stringliteral}{"{}1/("{}};}
\DoxyCodeLine{00449\ \ \ \ \ rational\_function\_string}
\DoxyCodeLine{00450\ \ \ \ \ \ \ <<\ formatted\_polynomial<degree,\ 1>(m\_denominator\_coeffs,\ 17);}
\DoxyCodeLine{00451\ \ \ \ \ rational\_function\_string\ <<\ \textcolor{stringliteral}{"{})\ [\(\backslash\)n\ \ "{}};}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ m\_numerator\_coeffs.cols();\ ++i)\ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ rational\_function\_string}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ <<\ formatted\_polynomial<degree,\ 1>(m\_numerator\_coeffs.col(i),\ 17);}
\DoxyCodeLine{00455\ \ \ \ \ \ \ rational\_function\_string\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n\ \ "{}};}
\DoxyCodeLine{00456\ \ \ \ \ \}}
\DoxyCodeLine{00457\ \ \ \ \ rational\_function\_string\ <<\ \textcolor{stringliteral}{"{}],\ t\ in\ "{}}\ <<\ m\_domain.formatted\_interval();}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordflow}{return}\ rational\_function\_string.str();}
\DoxyCodeLine{00460\ \ \ \}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{00463\ \ \ \textcolor{comment}{//\ Member\ variables}}
\DoxyCodeLine{00464\ \ \ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ Eigen::Matrix<double,\ degree\ +\ 1,\ dimension>\ m\_numerator\_coeffs;}
\DoxyCodeLine{00467\ \ \ Eigen::Matrix<double,\ degree\ +\ 1,\ 1>\ m\_denominator\_coeffs;}
\DoxyCodeLine{00468\ \ \ \mbox{\hyperlink{class_interval}{Interval}}\ m\_domain;}
\DoxyCodeLine{00469\ \};}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \textcolor{keyword}{template}<\textcolor{keywordtype}{size\_t}\ degree,\ \textcolor{keywordtype}{size\_t}\ dimension>}
\DoxyCodeLine{00472\ std::ostream\&}
\DoxyCodeLine{00473\ operator<<(std::ostream\&\ out,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_rational_function}{RationalFunction<degree,\ dimension>}}\&\ F)}
\DoxyCodeLine{00474\ \{}
\DoxyCodeLine{00475\ \ \ out\ <<\ F.formatted\_rational\_function();}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00477\ \}}

\end{DoxyCode}
