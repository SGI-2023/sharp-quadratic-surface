\doxysection{bivariate\+\_\+quadratic\+\_\+function.\+h}
\hypertarget{bivariate__quadratic__function_8h_source}{}\label{bivariate__quadratic__function_8h_source}\index{src/core/bivariate\_quadratic\_function.h@{src/core/bivariate\_quadratic\_function.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2023\ Adobe\ Research.\ All\ rights\ reserved.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ To\ view\ a\ copy\ of\ the\ license,\ visit\ LICENSE.md.}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}common.h"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{polynomial__function_8h}{polynomial\_function.h}}"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00010\ \textcolor{keywordtype}{double}\&}
\DoxyCodeLine{00011\ const\_coeff(Eigen::Ref<Eigen::Matrix<double,\ 6,\ dimension>>\ quadratic\_coeffs,}
\DoxyCodeLine{00012\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col)}
\DoxyCodeLine{00013\ \{}
\DoxyCodeLine{00014\ \ \ assert(col\ >\ dimension);}
\DoxyCodeLine{00015\ \ \ \textcolor{keywordflow}{return}\ quadratic\_coeffs(0,\ col);}
\DoxyCodeLine{00016\ \}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00019\ \textcolor{keywordtype}{double}\&}
\DoxyCodeLine{00020\ u\_coeff(Eigen::Ref<Eigen::Matrix<double,\ 6,\ dimension>>\ quadratic\_coeffs,}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col)}
\DoxyCodeLine{00022\ \{}
\DoxyCodeLine{00023\ \ \ assert(col\ >=\ 0);}
\DoxyCodeLine{00024\ \ \ assert(col\ <\ dimension);}
\DoxyCodeLine{00025\ \ \ \textcolor{keywordflow}{return}\ quadratic\_coeffs(1,\ col);}
\DoxyCodeLine{00026\ \}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00029\ \textcolor{keywordtype}{double}\&}
\DoxyCodeLine{00030\ v\_coeff(Eigen::Ref<Eigen::Matrix<double,\ 6,\ dimension>>\ quadratic\_coeffs,}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col)}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \ \ assert(col\ >=\ 0);}
\DoxyCodeLine{00034\ \ \ assert(col\ <\ dimension);}
\DoxyCodeLine{00035\ \ \ \textcolor{keywordflow}{return}\ quadratic\_coeffs(2,\ col);}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00039\ \textcolor{keywordtype}{double}\&}
\DoxyCodeLine{00040\ uv\_coeff(Eigen::Ref<Eigen::Matrix<double,\ 6,\ dimension>>\ quadratic\_coeffs,}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col)}
\DoxyCodeLine{00042\ \{}
\DoxyCodeLine{00043\ \ \ assert(col\ >=\ 0);}
\DoxyCodeLine{00044\ \ \ assert(col\ <\ dimension);}
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{return}\ quadratic\_coeffs(3,\ col);}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00049\ \textcolor{keywordtype}{double}\&}
\DoxyCodeLine{00050\ uu\_coeff(Eigen::Ref<Eigen::Matrix<double,\ 6,\ dimension>>\ quadratic\_coeffs,}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col)}
\DoxyCodeLine{00052\ \{}
\DoxyCodeLine{00053\ \ \ assert(col\ >=\ 0);}
\DoxyCodeLine{00054\ \ \ assert(col\ <\ dimension);}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{return}\ quadratic\_coeffs(4,\ col);}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00059\ \textcolor{keywordtype}{double}\&}
\DoxyCodeLine{00060\ vv\_coeff(Eigen::Ref<Eigen::Matrix<double,\ 6,\ dimension>>\ quadratic\_coeffs,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col)}
\DoxyCodeLine{00062\ \{}
\DoxyCodeLine{00063\ \ \ assert(col\ >=\ 0);}
\DoxyCodeLine{00064\ \ \ assert(col\ <\ dimension);}
\DoxyCodeLine{00065\ \ \ \textcolor{keywordflow}{return}\ quadratic\_coeffs(5,\ col);}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00073\ Eigen::Matrix<double,\ 1,\ 6>}
\DoxyCodeLine{00074\ generate\_quadratic\_monomials(\textcolor{keyword}{const}\ PlanarPoint\&\ domain\_point);}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00080\ Eigen::Matrix<double,\ 1,\ 3>}
\DoxyCodeLine{00081\ generate\_linear\_monomials(\textcolor{keyword}{const}\ PlanarPoint\&\ domain\_point);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00089\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00090\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00091\ evaluate\_quadratic\_mapping(}
\DoxyCodeLine{00092\ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 6,\ dimension>>\&\ quadratic\_coeffs,}
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{const}\ PlanarPoint\&\ domain\_point,}
\DoxyCodeLine{00094\ \ \ Eigen::Ref<Eigen::Matrix<double,\ 1,\ dimension>>\ quadratic\_evaluation)}
\DoxyCodeLine{00095\ \{}
\DoxyCodeLine{00096\ \ \ Eigen::Matrix<double,\ 1,\ 6>\ w\ =\ generate\_quadratic\_monomials(domain\_point);}
\DoxyCodeLine{00097\ \ \ quadratic\_evaluation\ =\ w\ *\ quadratic\_coeffs;}
\DoxyCodeLine{00098\ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00106\ \textcolor{keywordtype}{double}}
\DoxyCodeLine{00107\ evaluate\_quadratic(}
\DoxyCodeLine{00108\ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 6,\ 1>>\&\ quadratic\_coeffs,}
\DoxyCodeLine{00109\ \ \ \textcolor{keyword}{const}\ PlanarPoint\&\ domain\_point);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00116\ \textcolor{keywordtype}{double}}
\DoxyCodeLine{00117\ evaluate\_line(\textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 3,\ 1>>\&\ line\_coeffs,}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PlanarPoint\&\ domain\_point);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00126\ Eigen::Matrix<double,\ 6,\ 1>}
\DoxyCodeLine{00127\ compute\_linear\_product(}
\DoxyCodeLine{00128\ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 3,\ 1>>\&\ L1\_coeffs,}
\DoxyCodeLine{00129\ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 3,\ 1>>\&\ L2\_coeffs);}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00137\ Matrix6x3r}
\DoxyCodeLine{00138\ compute\_quadratic\_cross\_product(\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 3,\ 3>\&\ V\_coeffs,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<double,\ 3,\ 3>\&\ W\_coeffs);}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00145\ Eigen::Matrix<double,\ 3,\ 6>}
\DoxyCodeLine{00146\ u\_derivative\_matrix();}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00152\ Eigen::Matrix<double,\ 3,\ 6>}
\DoxyCodeLine{00153\ v\_derivative\_matrix();}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00160\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00161\ generate\_bezier\_to\_monomial\_matrix(}
\DoxyCodeLine{00162\ \ \ Eigen::Matrix<double,\ 6,\ 6>\&\ change\_of\_basis\_matrix);}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00169\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00170\ generate\_monomial\_to\_bezier\_matrix(}
\DoxyCodeLine{00171\ \ \ Eigen::Matrix<double,\ 6,\ 6>\&\ change\_of\_basis\_matrix);}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00178\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00179\ is\_conic\_standard\_form(\textcolor{keyword}{const}\ VectorXr\&\ C\_coeffs);}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00186\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00187\ std::string}
\DoxyCodeLine{00188\ formatted\_bivariate\_quadratic\_mapping(}
\DoxyCodeLine{00189\ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 6,\ dimension>>\&\ quadratic\_coeffs,}
\DoxyCodeLine{00190\ \ \ \textcolor{keywordtype}{size\_t}\ precision\ =\ 16)}
\DoxyCodeLine{00191\ \{}
\DoxyCodeLine{00192\ \ \ std::stringstream\ quadratic\_string;}
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ quadratic\_coeffs.cols();\ ++i)\ \{}
\DoxyCodeLine{00194\ \ \ \ \ quadratic\_string\ <<\ std::fixed\ <<\ std::setprecision(precision)}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ quadratic\_coeffs(0,\ i);}
\DoxyCodeLine{00196\ \ \ \ \ quadratic\_string\ <<\ formatted\_term(quadratic\_coeffs(1,\ i),\ \textcolor{stringliteral}{"{}u"{}},\ precision);}
\DoxyCodeLine{00197\ \ \ \ \ quadratic\_string\ <<\ formatted\_term(quadratic\_coeffs(2,\ i),\ \textcolor{stringliteral}{"{}v"{}},\ precision);}
\DoxyCodeLine{00198\ \ \ \ \ quadratic\_string\ <<\ formatted\_term(quadratic\_coeffs(3,\ i),\ \textcolor{stringliteral}{"{}uv"{}},\ precision);}
\DoxyCodeLine{00199\ \ \ \ \ quadratic\_string\ <<\ formatted\_term(}
\DoxyCodeLine{00200\ \ \ \ \ \ \ quadratic\_coeffs(4,\ i),\ \textcolor{stringliteral}{"{}u\string^2"{}},\ precision);}
\DoxyCodeLine{00201\ \ \ \ \ quadratic\_string\ <<\ formatted\_term(}
\DoxyCodeLine{00202\ \ \ \ \ \ \ quadratic\_coeffs(5,\ i),\ \textcolor{stringliteral}{"{}v\string^2"{}},\ precision);}
\DoxyCodeLine{00203\ \ \ \ \ quadratic\_string\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00204\ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \textcolor{keywordflow}{return}\ quadratic\_string.str();}
\DoxyCodeLine{00207\ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00213\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ dimension>}
\DoxyCodeLine{00214\ std::string}
\DoxyCodeLine{00215\ formatted\_bivariate\_linear\_mapping(}
\DoxyCodeLine{00216\ \ \ \textcolor{keyword}{const}\ Eigen::Ref<\textcolor{keyword}{const}\ Eigen::Matrix<double,\ 3,\ dimension>>\&\ line\_coeffs,}
\DoxyCodeLine{00217\ \ \ \textcolor{keywordtype}{size\_t}\ precision\ =\ 16)}
\DoxyCodeLine{00218\ \{}
\DoxyCodeLine{00219\ \ \ std::stringstream\ line\_string;}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ dimension;\ ++i)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ line\_string\ <<\ std::fixed\ <<\ std::setprecision(precision)}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ line\_coeffs(0,\ i);}
\DoxyCodeLine{00223\ \ \ \ \ line\_string\ <<\ formatted\_term(line\_coeffs(1,\ i),\ \textcolor{stringliteral}{"{}u"{}},\ precision);}
\DoxyCodeLine{00224\ \ \ \ \ line\_string\ <<\ formatted\_term(line\_coeffs(2,\ i),\ \textcolor{stringliteral}{"{}v"{}},\ precision);}
\DoxyCodeLine{00225\ \ \ \ \ line\_string\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00226\ \ \ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \textcolor{keywordflow}{return}\ line\_string.str();}
\DoxyCodeLine{00229\ \}}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00240\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00241\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00242\ generate\_quadratic\_coordinate\_affine\_transformation\_matrix(}
\DoxyCodeLine{00243\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 2>\&\ linear\_transformation,}
\DoxyCodeLine{00244\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 1,\ 2>\&\ translation,}
\DoxyCodeLine{00245\ \ \ Eigen::Matrix<Scalar,\ 6,\ 6>\&\ change\_of\_basis\_matrix)}
\DoxyCodeLine{00246\ \{}
\DoxyCodeLine{00247\ \ \ \textcolor{comment}{//\ Get\ matrix\ information}}
\DoxyCodeLine{00248\ \ \ Scalar\ b11\ =\ linear\_transformation(0,\ 0);}
\DoxyCodeLine{00249\ \ \ Scalar\ b12\ =\ linear\_transformation(0,\ 1);}
\DoxyCodeLine{00250\ \ \ Scalar\ b21\ =\ linear\_transformation(1,\ 0);}
\DoxyCodeLine{00251\ \ \ Scalar\ b22\ =\ linear\_transformation(1,\ 1);}
\DoxyCodeLine{00252\ \ \ Scalar\ b1\ =\ translation[0];}
\DoxyCodeLine{00253\ \ \ Scalar\ b2\ =\ translation[1];}
\DoxyCodeLine{00254\ \ \ Scalar\ one(1);}
\DoxyCodeLine{00255\ \ \ Scalar\ zero(0);}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \textcolor{comment}{//\ Set\ matrix}}
\DoxyCodeLine{00258\ \ \ change\_of\_basis\_matrix\ <<\ one,\ b1,\ b2,\ b1\ *\ b2,\ b1\ *\ b1,\ b2\ *\ b2,\ zero,\ b11,}
\DoxyCodeLine{00259\ \ \ \ \ b12,\ b11\ *\ b2\ +\ b12\ *\ b1,\ 2\ *\ b1\ *\ b11,\ 2\ *\ b2\ *\ b12,\ zero,\ b21,\ b22,}
\DoxyCodeLine{00260\ \ \ \ \ b22\ *\ b1\ +\ b21\ *\ b2,\ 2\ *\ b1\ *\ b21,\ 2\ *\ b2\ *\ b22,\ zero,\ zero,\ zero,}
\DoxyCodeLine{00261\ \ \ \ \ b11\ *\ b22\ +\ b21\ *\ b12,\ 2\ *\ b11\ *\ b21,\ 2\ *\ b12\ *\ b22,\ zero,\ zero,\ zero,}
\DoxyCodeLine{00262\ \ \ \ \ b11\ *\ b12,\ b11\ *\ b11,\ b12\ *\ b12,\ zero,\ zero,\ zero,\ b21\ *\ b22,\ b21\ *\ b21,}
\DoxyCodeLine{00263\ \ \ \ \ b22\ *\ b22;}
\DoxyCodeLine{00264\ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00273\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00274\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00275\ generate\_quadratic\_coordinate\_translation\_matrix(}
\DoxyCodeLine{00276\ \ \ \textcolor{keywordtype}{double}\ du,}
\DoxyCodeLine{00277\ \ \ \textcolor{keywordtype}{double}\ dv,}
\DoxyCodeLine{00278\ \ \ Eigen::Matrix<Scalar,\ 6,\ 6>\&\ change\_of\_basis\_matrix)}
\DoxyCodeLine{00279\ \{}
\DoxyCodeLine{00280\ \ \ \textcolor{comment}{//\ Build\ (inverse)\ translation\ and\ linear\ identity\ matrix}}
\DoxyCodeLine{00281\ \ \ Eigen::Matrix<Scalar,\ 2,\ 1>\ translation\ =\ \{\ -\/du,\ -\/dv\ \};}
\DoxyCodeLine{00282\ \ \ Eigen::Matrix<Scalar,\ 2,\ 2>\ identity;}
\DoxyCodeLine{00283\ \ \ identity\ <<\ Scalar(1),\ Scalar(0),\ Scalar(0),\ Scalar(1);}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \textcolor{comment}{//\ Generate\ the\ translation\ transformation\ as\ a\ special\ case\ of\ an\ affine}}
\DoxyCodeLine{00286\ \ \ \textcolor{comment}{//\ transformation}}
\DoxyCodeLine{00287\ \ \ generate\_quadratic\_coordinate\_affine\_transformation\_matrix<Scalar>(}
\DoxyCodeLine{00288\ \ \ \ \ identity,\ translation,\ change\_of\_basis\_matrix);}
\DoxyCodeLine{00289\ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00300\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00301\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00302\ generate\_quadratic\_coordinate\_barycentric\_transformation\_matrix(}
\DoxyCodeLine{00303\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 3,\ 3>\&\ barycentric\_transformation,}
\DoxyCodeLine{00304\ \ \ Eigen::Matrix<Scalar,\ 6,\ 6>\&\ change\_of\_basis\_matrix)}
\DoxyCodeLine{00305\ \{}
\DoxyCodeLine{00306\ \ \ Eigen::Matrix<Scalar,\ 2,\ 2>\ linear\_transformation;}
\DoxyCodeLine{00307\ \ \ Eigen::Matrix<Scalar,\ 2,\ 1>\ translation;}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \textcolor{comment}{//\ Get\ relevant\ barycentric\ matrix\ components.\ Since\ the\ w\ coordinate\ is}}
\DoxyCodeLine{00310\ \ \ \textcolor{comment}{//\ discarded,\ we\ only\ use\ the\ first\ two\ rows\ of\ the\ barycentric\ transformation}}
\DoxyCodeLine{00311\ \ \ Scalar\ a11\ =\ barycentric\_transformation(0,\ 0);}
\DoxyCodeLine{00312\ \ \ Scalar\ a12\ =\ barycentric\_transformation(0,\ 1);}
\DoxyCodeLine{00313\ \ \ Scalar\ a13\ =\ barycentric\_transformation(0,\ 2);}
\DoxyCodeLine{00314\ \ \ Scalar\ a21\ =\ barycentric\_transformation(1,\ 0);}
\DoxyCodeLine{00315\ \ \ Scalar\ a22\ =\ barycentric\_transformation(1,\ 1);}
\DoxyCodeLine{00316\ \ \ Scalar\ a23\ =\ barycentric\_transformation(1,\ 2);}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \textcolor{comment}{//\ Build\ affine\ transformation\ from\ barycentric\ transformation\ with\ w\ =\ 1\ -\/\ u}}
\DoxyCodeLine{00319\ \ \ \textcolor{comment}{//\ -\/\ v}}
\DoxyCodeLine{00320\ \ \ linear\_transformation\ <<\ a11\ -\/\ a13,\ a21\ -\/\ a23,\ a12\ -\/\ a13,\ a22\ -\/\ a23;}
\DoxyCodeLine{00321\ \ \ translation\ <<\ a13,\ a23;}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \textcolor{comment}{//\ Get\ change\ of\ basis\ matrix\ from\ the\ affine\ transformation}}
\DoxyCodeLine{00324\ \ \ generate\_quadratic\_coordinate\_affine\_transformation\_matrix<Scalar>(}
\DoxyCodeLine{00325\ \ \ \ \ linear\_transformation,\ translation,\ change\_of\_basis\_matrix);}
\DoxyCodeLine{00326\ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00338\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00339\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00340\ generate\_quadratic\_coordinate\_domain\_triangle\_normalization\_matrix(}
\DoxyCodeLine{00341\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 1>\&\ v0,}
\DoxyCodeLine{00342\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 1>\&\ v1,}
\DoxyCodeLine{00343\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 1>\&\ v2,}
\DoxyCodeLine{00344\ \ \ Eigen::Matrix<Scalar,\ 6,\ 6>\&\ change\_of\_basis\_matrix)}
\DoxyCodeLine{00345\ \{}
\DoxyCodeLine{00346\ \ \ \textcolor{comment}{//\ Generate\ affine\ transformation\ mapping\ the\ standard\ triangle\ to\ the\ new}}
\DoxyCodeLine{00347\ \ \ \textcolor{comment}{//\ triangle}}
\DoxyCodeLine{00348\ \ \ Eigen::Matrix<Scalar,\ 2,\ 2>\ linear\_transformation;}
\DoxyCodeLine{00349\ \ \ Eigen::Matrix<Scalar,\ 2,\ 1>\ translation;}
\DoxyCodeLine{00350\ \ \ linear\_transformation.row(0)\ =\ v1\ -\/\ v0;}
\DoxyCodeLine{00351\ \ \ linear\_transformation.row(1)\ =\ v2\ -\/\ v0;}
\DoxyCodeLine{00352\ \ \ translation\ =\ v0;}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \textcolor{comment}{//\ Get\ change\ of\ basis\ matrix\ from\ the\ affine\ transformation}}
\DoxyCodeLine{00355\ \ \ generate\_quadratic\_coordinate\_affine\_transformation\_matrix<Scalar>(}
\DoxyCodeLine{00356\ \ \ \ \ linear\_transformation,\ translation,\ change\_of\_basis\_matrix);}
\DoxyCodeLine{00357\ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00365\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Scalar>}
\DoxyCodeLine{00366\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00367\ generate\_reparametrization(}
\DoxyCodeLine{00368\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 1>\&\ v0,}
\DoxyCodeLine{00369\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 1>\&\ v1,}
\DoxyCodeLine{00370\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,\ 2,\ 1>\&\ v2,}
\DoxyCodeLine{00371\ \ \ Eigen::Matrix<Scalar,\ 2,\ 2>\&\ general\_to\_canonical\_reparametrization,}
\DoxyCodeLine{00372\ \ \ Eigen::Matrix<Scalar,\ 2,\ 2>\&\ canonical\_to\_general\_reparametrization)}
\DoxyCodeLine{00373\ \{}
\DoxyCodeLine{00374\ \ \ Scalar\ l0\ =\ (v1\ -\/\ v0).norm();}
\DoxyCodeLine{00375\ \ \ ;}
\DoxyCodeLine{00376\ \ \ Scalar\ l1\ =\ (v2\ -\/\ v1).norm();}
\DoxyCodeLine{00377\ \ \ ;}
\DoxyCodeLine{00378\ \ \ Scalar\ l2\ =\ (v0\ -\/\ v2).norm();}
\DoxyCodeLine{00379\ \ \ ;}
\DoxyCodeLine{00380\ \ \ Scalar\ cos\_angle\ =\ (l0\ *\ l0\ +\ l2\ *\ l2\ -\/\ l1\ *\ l1)\ /\ (2\ *\ l0\ *\ l2);}
\DoxyCodeLine{00381\ \ \ Scalar\ sin\_angle\ =\ sqrt(1\ -\/\ cos\_angle\ *\ cos\_angle);}
\DoxyCodeLine{00382\ \ \ general\_to\_canonical\_reparametrization\ <<\ Scalar(1)\ /\ l0,\ Scalar(0),}
\DoxyCodeLine{00383\ \ \ \ \ -\/cos\_angle\ /\ (l0\ *\ sin\_angle),\ Scalar(1)\ /\ (l2\ *\ sin\_angle);}
\DoxyCodeLine{00384\ \ \ canonical\_to\_general\_reparametrization\ <<\ l0,\ l2\ *\ cos\_angle,\ Scalar(0),}
\DoxyCodeLine{00385\ \ \ \ \ l2\ *\ sin\_angle;}
\DoxyCodeLine{00386\ \}}

\end{DoxyCode}
