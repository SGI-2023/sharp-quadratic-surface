\doxysection{test\+\_\+assemble\+\_\+matrix.\+cpp}
\hypertarget{test__assemble__matrix_8cpp_source}{}\label{test__assemble__matrix_8cpp_source}\index{src/tests/test\_assemble\_matrix.cpp@{src/tests/test\_assemble\_matrix.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{affine__manifold_8h}{affine\_manifold.h}}"{}}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ "{}common.h"{}}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}compute\_local\_twelve\_split\_hessian.h"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{optimize__spline__surface_8h}{optimize\_spline\_surface.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{twelve__split__spline_8h}{twelve\_split\_spline.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}generate\_position\_data.h"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}generate\_shapes.h"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <Eigen/Core>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <catch2/catch\_test\_macros.hpp>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ Display\ quadratic\ surface\ mapping\ output\ to\ console}}
\DoxyCodeLine{00020\ \textcolor{comment}{//void\ display\_quadratic\_surface\_mapping(const\ Eigen::MatrixXd\ \&uv,}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ Eigen::MatrixXi\ \&F,}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ double\ uv\_coeff,\ double\ uu\_coeff,}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ double\ vv\_coeff)\ \{}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ \ spdlog::info("{}Using\ quadratic\ \{\}\ *\ uv\ +\ \{\}\ *\ u\string^2\ +\ \{\}\ *\ v\string^2"{},\ uv\_coeff,}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uu\_coeff,\ vv\_coeff);}}
\DoxyCodeLine{00026\ \textcolor{comment}{//}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ \ //\ Build\ parametric\ domain\ manifold}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ \ ParametricAffineManifold\ parametric\_affine\_manifold(F,\ uv);}}
\DoxyCodeLine{00029\ \textcolor{comment}{//\ \ spdlog::info("{}Using\ uv\ domain\ triangle\(\backslash\)n\{\}"{},\ uv);}}
\DoxyCodeLine{00030\ \textcolor{comment}{//}}
\DoxyCodeLine{00031\ \textcolor{comment}{//\ \ //\ Build\ halfedge\ for\ edge\ index\ management}}
\DoxyCodeLine{00032\ \textcolor{comment}{//\ \ std::vector<std::vector<size\_t>>\ corner\_to\_he;}}
\DoxyCodeLine{00033\ \textcolor{comment}{//\ \ std::vector<std::pair<size\_t,\ size\_t>>\ he\_to\_corner;}}
\DoxyCodeLine{00034\ \textcolor{comment}{//\ \ Halfedge\ halfedge(F,\ corner\_to\_he,\ he\_to\_corner);}}
\DoxyCodeLine{00035\ \textcolor{comment}{//}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ \ //\ Generate\ functors\ to\ evaluate\ the\ quadratic\ and\ its\ gradients}}
\DoxyCodeLine{00037\ \textcolor{comment}{//\ \ QuadraticPositionFunction\ position\_func(uv\_coeff,\ uu\_coeff,\ vv\_coeff);}}
\DoxyCodeLine{00038\ \textcolor{comment}{//\ \ QuadraticGradientFunction\ gradient\_func(uv\_coeff,\ uu\_coeff,\ vv\_coeff);}}
\DoxyCodeLine{00039\ \textcolor{comment}{//}}
\DoxyCodeLine{00040\ \textcolor{comment}{//\ \ //\ Display\ function\ corner\ and\ midpoint\ data}}
\DoxyCodeLine{00041\ \textcolor{comment}{//\ \ std::vector<std::array<TriangleCornerFunctionData,\ 3>>\ corner\_data;}}
\DoxyCodeLine{00042\ \textcolor{comment}{//\ \ std::vector<std::array<TriangleMidpointFunctionData,\ 3>>\ midpoint\_data;}}
\DoxyCodeLine{00043\ \textcolor{comment}{//\ \ generate\_parametric\_affine\_manifold\_corner\_data(}}
\DoxyCodeLine{00044\ \textcolor{comment}{//\ \ \ \ \ \ position\_func,\ gradient\_func,\ parametric\_affine\_manifold,\ corner\_data);}}
\DoxyCodeLine{00045\ \textcolor{comment}{//\ \ generate\_parametric\_affine\_manifold\_midpoint\_data(}}
\DoxyCodeLine{00046\ \textcolor{comment}{//\ \ \ \ \ \ gradient\_func,\ parametric\_affine\_manifold,\ midpoint\_data);}}
\DoxyCodeLine{00047\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 3;\ ++i)\ \{}}
\DoxyCodeLine{00048\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Data\ for\ corner\ \{\}"{},\ i);}}
\DoxyCodeLine{00049\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Fuction\ value:\ \{\}"{},}}
\DoxyCodeLine{00050\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corner\_data[0][i].function\_value.transpose());}}
\DoxyCodeLine{00051\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}First\ edge\ derivative:\ \{\}"{},}}
\DoxyCodeLine{00052\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corner\_data[0][i].first\_edge\_derivative.transpose());}}
\DoxyCodeLine{00053\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Second\ edge\ derivative:\ \{\}"{},}}
\DoxyCodeLine{00054\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corner\_data[0][i].second\_edge\_derivative.transpose());}}
\DoxyCodeLine{00055\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00056\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 3;\ ++i)\ \{}}
\DoxyCodeLine{00057\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Data\ for\ midpoint\ opposite\ corner\ \{\}"{},\ i);}}
\DoxyCodeLine{00058\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Midpoint\ derivative:\ \{\}"{},}}
\DoxyCodeLine{00059\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ midpoint\_data[0][i].normal\_derivative.transpose());}}
\DoxyCodeLine{00060\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00061\ \textcolor{comment}{//}}
\DoxyCodeLine{00062\ \textcolor{comment}{//\ \ //\ Generate\ the\ surface\ mapping}}
\DoxyCodeLine{00063\ \textcolor{comment}{//\ \ std::array<Eigen::Matrix<double,\ 6,\ 3>,\ 12>\ surface\_mappings;}}
\DoxyCodeLine{00064\ \textcolor{comment}{//\ \ generate\_twelve\_split\_spline\_patch\_surface\_mapping<double>(}}
\DoxyCodeLine{00065\ \textcolor{comment}{//\ \ \ \ \ \ corner\_data[0],\ midpoint\_data[0],\ surface\_mappings);}}
\DoxyCodeLine{00066\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 12;\ ++i)\ \{}}
\DoxyCodeLine{00067\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Surface\ mapping\ for\ patch\ \{\}:\(\backslash\)n\{\}"{},\ i,\ surface\_mappings[i]);}}
\DoxyCodeLine{00068\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00069\ \textcolor{comment}{//}}
\DoxyCodeLine{00070\ \textcolor{comment}{//\ \ //\ Reorganize\ surface\ mapping\ into\ x,\ y,\ z\ coordinates}}
\DoxyCodeLine{00071\ \textcolor{comment}{//\ \ Eigen::Matrix<double,\ 12,\ 6>\ x\_mat,\ y\_mat,\ z\_mat;}}
\DoxyCodeLine{00072\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 12;\ ++i)\ \{}}
\DoxyCodeLine{00073\ \textcolor{comment}{//\ \ \ \ for\ (size\_t\ j\ =\ 0;\ j\ <\ 6;\ ++j)\ \{}}
\DoxyCodeLine{00074\ \textcolor{comment}{//\ \ \ \ \ \ x\_mat(i,\ j)\ =\ surface\_mappings[i](j,\ 0);}}
\DoxyCodeLine{00075\ \textcolor{comment}{//\ \ \ \ \ \ y\_mat(i,\ j)\ =\ surface\_mappings[i](j,\ 1);}}
\DoxyCodeLine{00076\ \textcolor{comment}{//\ \ \ \ \ \ z\_mat(i,\ j)\ =\ surface\_mappings[i](j,\ 2);}}
\DoxyCodeLine{00077\ \textcolor{comment}{//\ \ \ \ \}}}
\DoxyCodeLine{00078\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00079\ \textcolor{comment}{//\ \ spdlog::info("{}x\ coefficient\ matrix\(\backslash\)n\{\}"{},\ x\_mat);}}
\DoxyCodeLine{00080\ \textcolor{comment}{//\ \ spdlog::info("{}y\ coefficient\ matrix\(\backslash\)n\{\}"{},\ y\_mat);}}
\DoxyCodeLine{00081\ \textcolor{comment}{//\ \ spdlog::info("{}z\ coefficient\ matrix\(\backslash\)n\{\}"{},\ z\_mat);}}
\DoxyCodeLine{00082\ \textcolor{comment}{//\}}}
\DoxyCodeLine{00083\ \textcolor{comment}{//}}
\DoxyCodeLine{00084\ \textcolor{comment}{//bool\ generate\_twelve\_split\_quadratic\_surface\_mapping(}}
\DoxyCodeLine{00085\ \textcolor{comment}{//\ \ \ \ const\ Eigen::MatrixXd\ \&uv,\ const\ Eigen::MatrixXi\ \&F,\ double\ uv\_coeff,}}
\DoxyCodeLine{00086\ \textcolor{comment}{//\ \ \ \ double\ uu\_coeff,\ double\ vv\_coeff,}}
\DoxyCodeLine{00087\ \textcolor{comment}{//\ \ \ \ std::array<SpatialVector,\ 3>\ \&vertex\_positions\_T,}}
\DoxyCodeLine{00088\ \textcolor{comment}{//\ \ \ \ std::array<Matrix2x3r,\ 3>\ \&vertex\_gradients\_T,}}
\DoxyCodeLine{00089\ \textcolor{comment}{//\ \ \ \ std::array<SpatialVector,\ 3>\ \&edge\_gradients\_T,}}
\DoxyCodeLine{00090\ \textcolor{comment}{//\ \ \ \ std::array<SpatialVector,\ 3>\ \&initial\_vertex\_positions\_T,}}
\DoxyCodeLine{00091\ \textcolor{comment}{//\ \ \ \ std::array<PlanarPoint,\ 3>\ \&face\_vertex\_uv\_positions,}}
\DoxyCodeLine{00092\ \textcolor{comment}{//\ \ \ \ std::array<Matrix2x2r,\ 3>\ \&corner\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00093\ \textcolor{comment}{//\ \ \ \ std::array<PlanarPoint,\ 3>\ \&midpoint\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00094\ \textcolor{comment}{//\ \ \ \ std::array<bool,\ 3>\ \&reverse\_edge\_orientations)\ \{}}
\DoxyCodeLine{00095\ \textcolor{comment}{//\ \ spdlog::info("{}Using\ quadratic\ \{\}\ *\ uv\ +\ \{\}\ *\ u\string^2\ +\ \{\}\ *\ v\string^2"{},\ uv\_coeff,}}
\DoxyCodeLine{00096\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uu\_coeff,\ vv\_coeff);}}
\DoxyCodeLine{00097\ \textcolor{comment}{//}}
\DoxyCodeLine{00098\ \textcolor{comment}{//\ \ //\ Build\ parametric\ domain\ manifold}}
\DoxyCodeLine{00099\ \textcolor{comment}{//\ \ ParametricAffineManifold\ parametric\_affine\_manifold(F,\ uv);}}
\DoxyCodeLine{00100\ \textcolor{comment}{//\ \ spdlog::info("{}Using\ uv\ domain\ triangle\(\backslash\)n\{\}"{},\ uv);}}
\DoxyCodeLine{00101\ \textcolor{comment}{//}}
\DoxyCodeLine{00102\ \textcolor{comment}{//\ \ //\ Build\ halfedge\ for\ edge\ index\ management}}
\DoxyCodeLine{00103\ \textcolor{comment}{//\ \ std::vector<std::vector<size\_t>>\ corner\_to\_he;}}
\DoxyCodeLine{00104\ \textcolor{comment}{//\ \ std::vector<std::pair<size\_t,\ size\_t>>\ he\_to\_corner;}}
\DoxyCodeLine{00105\ \textcolor{comment}{//\ \ Halfedge\ halfedge(F,\ corner\_to\_he,\ he\_to\_corner);}}
\DoxyCodeLine{00106\ \textcolor{comment}{//}}
\DoxyCodeLine{00107\ \textcolor{comment}{//\ \ //\ Generate\ functors\ to\ evaluate\ the\ quadratic\ and\ its\ gradients}}
\DoxyCodeLine{00108\ \textcolor{comment}{//\ \ QuadraticPositionFunction\ position\_func(uv\_coeff,\ uu\_coeff,\ vv\_coeff);}}
\DoxyCodeLine{00109\ \textcolor{comment}{//\ \ QuadraticGradientFunction\ gradient\_func(uv\_coeff,\ uu\_coeff,\ vv\_coeff);}}
\DoxyCodeLine{00110\ \textcolor{comment}{//}}
\DoxyCodeLine{00111\ \textcolor{comment}{//\ \ //\ Get\ position\ and\ gradient\ values}}
\DoxyCodeLine{00112\ \textcolor{comment}{//\ \ MatrixXr\ V;}}
\DoxyCodeLine{00113\ \textcolor{comment}{//\ \ std::vector<Matrix2x3r>\ vertex\_gradients;}}
\DoxyCodeLine{00114\ \textcolor{comment}{//\ \ std::vector<std::array<SpatialVector,\ 3>>\ edge\_gradients;}}
\DoxyCodeLine{00115\ \textcolor{comment}{//\ \ generate\_parametric\_affine\_manifold\_vertex\_positions(}}
\DoxyCodeLine{00116\ \textcolor{comment}{//\ \ \ \ \ \ position\_func,\ parametric\_affine\_manifold,\ V);}}
\DoxyCodeLine{00117\ \textcolor{comment}{//\ \ generate\_parametric\_affine\_manifold\_vertex\_gradients(}}
\DoxyCodeLine{00118\ \textcolor{comment}{//\ \ \ \ \ \ gradient\_func,\ parametric\_affine\_manifold,\ vertex\_gradients);}}
\DoxyCodeLine{00119\ \textcolor{comment}{//\ \ generate\_parametric\_affine\_manifold\_edge\_gradients(}}
\DoxyCodeLine{00120\ \textcolor{comment}{//\ \ \ \ \ \ gradient\_func,\ parametric\_affine\_manifold,\ halfedge,\ edge\_gradients);}}
\DoxyCodeLine{00121\ \textcolor{comment}{//}}
\DoxyCodeLine{00122\ \textcolor{comment}{//\ \ //\ Display\ values}}
\DoxyCodeLine{00123\ \textcolor{comment}{//\ \ spdlog::info("{}Vertex\ positions:\(\backslash\)n\{\}"{},\ V);}}
\DoxyCodeLine{00124\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ vertex\_gradients.size();\ ++i)\ \{}}
\DoxyCodeLine{00125\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Vertex\ gradients\ for\ vertex\ \{\}:\(\backslash\)n\{\}"{},\ i,\ vertex\_gradients[i]);}}
\DoxyCodeLine{00126\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00127\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 3;\ ++i)\ \{}}
\DoxyCodeLine{00128\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Edge\ gradient\ opposite\ vertex\ \{\}:\ \{\}"{},\ i,}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ edge\_gradients[0][i].transpose());}}
\DoxyCodeLine{00130\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00131\ \textcolor{comment}{//}}
\DoxyCodeLine{00132\ \textcolor{comment}{//\ \ //\ Display\ uv\ coordinates}}
\DoxyCodeLine{00133\ \textcolor{comment}{//\ \ //\ spdlog::info("{}Affine\ manifold\ uv\ positions:"{});}}
\DoxyCodeLine{00134\ \textcolor{comment}{//\ \ //\ PlanarPoint\ uv\_coords;}}
\DoxyCodeLine{00135\ \textcolor{comment}{//\ \ //\ parametric\_affine\_manifold.get\_vertex\_global\_uv(0,\ uv\_coords);}}
\DoxyCodeLine{00136\ \textcolor{comment}{//\ \ //\ spdlog::info(uv\_coords.transpose());}}
\DoxyCodeLine{00137\ \textcolor{comment}{//\ \ //\ parametric\_affine\_manifold.get\_vertex\_global\_uv(1,\ uv\_coords);}}
\DoxyCodeLine{00138\ \textcolor{comment}{//\ \ //\ spdlog::info(uv\_coords.transpose());}}
\DoxyCodeLine{00139\ \textcolor{comment}{//\ \ //\ parametric\_affine\_manifold.get\_vertex\_global\_uv(2,\ uv\_coords);}}
\DoxyCodeLine{00140\ \textcolor{comment}{//\ \ //\ spdlog::info(uv\_coords.transpose());}}
\DoxyCodeLine{00141\ \textcolor{comment}{//}}
\DoxyCodeLine{00142\ \textcolor{comment}{//\ \ //\ Compute\ the\ hessian\ for\ this\ configuration}}
\DoxyCodeLine{00143\ \textcolor{comment}{//\ \ OptimizationParameters\ optimization\_params;}}
\DoxyCodeLine{00144\ \textcolor{comment}{//\ \ optimization\_params.parametrized\_quadratic\_surface\_mapping\_factor\ =\ 1;}}
\DoxyCodeLine{00145\ \textcolor{comment}{//\ \ TriangleEnergy<TwelveSplitVar>\ triangle\_energy(optimization\_params);}}
\DoxyCodeLine{00146\ \textcolor{comment}{//}}
\DoxyCodeLine{00147\ \textcolor{comment}{//\ \ //\ Build\ vertex\ positions\ and\ gradients}}
\DoxyCodeLine{00148\ \textcolor{comment}{//\ \ int\ i\ =\ 0;}}
\DoxyCodeLine{00149\ \textcolor{comment}{//\ \ int\ j\ =\ 1;}}
\DoxyCodeLine{00150\ \textcolor{comment}{//\ \ int\ k\ =\ 2;}}
\DoxyCodeLine{00151\ \textcolor{comment}{//\ \ int\ face\_index\ =\ 0;}}
\DoxyCodeLine{00152\ \textcolor{comment}{//\ \ size\_t\ num\_vertices\ =\ V.rows();}}
\DoxyCodeLine{00153\ \textcolor{comment}{//\ \ std::vector<SpatialVector>\ vertex\_positions(num\_vertices);}}
\DoxyCodeLine{00154\ \textcolor{comment}{//\ \ std::vector<SpatialVector>\ initial\_vertex\_positions(num\_vertices);}}
\DoxyCodeLine{00155\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ num\_vertices;\ ++i)\ \{}}
\DoxyCodeLine{00156\ \textcolor{comment}{//\ \ \ \ vertex\_positions[i]\ =\ V.row(i);}}
\DoxyCodeLine{00157\ \textcolor{comment}{//\ \ \ \ initial\_vertex\_positions[i]\ =\ V.row(i);}}
\DoxyCodeLine{00158\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00159\ \textcolor{comment}{//}}
\DoxyCodeLine{00160\ \textcolor{comment}{//\ \ build\_face\_variable\_vector(vertex\_positions,\ i,\ j,\ k,\ vertex\_positions\_T);}}
\DoxyCodeLine{00161\ \textcolor{comment}{//\ \ build\_face\_variable\_vector(vertex\_gradients,\ i,\ j,\ k,\ vertex\_gradients\_T);}}
\DoxyCodeLine{00162\ \textcolor{comment}{//\ \ build\_face\_variable\_vector(initial\_vertex\_positions,\ i,\ j,\ k,}}
\DoxyCodeLine{00163\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ initial\_vertex\_positions\_T);}}
\DoxyCodeLine{00164\ \textcolor{comment}{//\ \ edge\_gradients\_T\ =\ edge\_gradients[face\_index];}}
\DoxyCodeLine{00165\ \textcolor{comment}{//}}
\DoxyCodeLine{00166\ \textcolor{comment}{//\ \ //\ Get\ the\ global\ uv\ values\ for\ the\ face\ vertices}}
\DoxyCodeLine{00167\ \textcolor{comment}{//\ \ parametric\_affine\_manifold.get\_face\_global\_uv(face\_index,}}
\DoxyCodeLine{00168\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ face\_vertex\_uv\_positions);}}
\DoxyCodeLine{00169\ \textcolor{comment}{//}}
\DoxyCodeLine{00170\ \textcolor{comment}{//\ \ //\ Get\ corner\ uv\ positions\ for\ the\ given\ face\ corners}}
\DoxyCodeLine{00171\ \textcolor{comment}{//\ \ parametric\_affine\_manifold.get\_face\_corner\_charts(}}
\DoxyCodeLine{00172\ \textcolor{comment}{//\ \ \ \ \ \ face\_index,\ corner\_to\_corner\_uv\_positions);}}
\DoxyCodeLine{00173\ \textcolor{comment}{//}}
\DoxyCodeLine{00174\ \textcolor{comment}{//\ \ //\ Get\ corner\ uv\ positions\ for\ the\ given\ face\ edges}}
\DoxyCodeLine{00175\ \textcolor{comment}{//\ \ std::array<MatrixXr,\ 3>\ face\_edge\_uv\_positions;}}
\DoxyCodeLine{00176\ \textcolor{comment}{//\ \ parametric\_affine\_manifold.get\_face\_edge\_charts(face\_index,}}
\DoxyCodeLine{00177\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ face\_edge\_uv\_positions);}}
\DoxyCodeLine{00178\ \textcolor{comment}{//}}
\DoxyCodeLine{00179\ \textcolor{comment}{//\ \ //\ Get\ only\ the\ uv\ position\ from\ the\ edge\ midpoint\ to\ the\ opposite\ corner}}
\DoxyCodeLine{00180\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 3;\ ++i)\ \{}}
\DoxyCodeLine{00181\ \textcolor{comment}{//\ \ \ \ midpoint\_to\_corner\_uv\_positions[i]\ =\ face\_edge\_uv\_positions[i].row(1);}}
\DoxyCodeLine{00182\ \textcolor{comment}{//\ \ \ \ spdlog::info("{}Midpoint\ to\ corner\ uv\ position\ \{\}:\ \{\}"{},\ i,}}
\DoxyCodeLine{00183\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ midpoint\_to\_corner\_uv\_positions[i]);}}
\DoxyCodeLine{00184\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00185\ \textcolor{comment}{//}}
\DoxyCodeLine{00186\ \textcolor{comment}{//\ \ //\ Get\ edge\ orientations}}
\DoxyCodeLine{00187\ \textcolor{comment}{//\ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 3;\ ++i)\ \{}}
\DoxyCodeLine{00188\ \textcolor{comment}{//\ \ \ \ EdgeManifoldChart\ const\ \&chart\ =}}
\DoxyCodeLine{00189\ \textcolor{comment}{//\ \ \ \ \ \ \ \ parametric\_affine\_manifold.get\_edge\_chart(face\_index,\ i);}}
\DoxyCodeLine{00190\ \textcolor{comment}{//\ \ \ \ reverse\_edge\_orientations[i]\ =\ (chart.top\_face\_index\ !=\ face\_index);}}
\DoxyCodeLine{00191\ \textcolor{comment}{//\ \ \}}}
\DoxyCodeLine{00192\ \textcolor{comment}{//}}
\DoxyCodeLine{00193\ \textcolor{comment}{//\ \ //\ \ \ double\ local\_energy;}}
\DoxyCodeLine{00194\ \textcolor{comment}{//\ \ //\ \ \ TwelveSplitGradient\ local\_derivatives;}}
\DoxyCodeLine{00195\ \textcolor{comment}{//\ \ //\ \ \ TwelveSplitHessian\ local\_hessian;}}
\DoxyCodeLine{00196\ \textcolor{comment}{//\ \ //\ \ \ compute\_local\_twelve\_split\_energy\_quadratic(}}
\DoxyCodeLine{00197\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ \ vertex\_positions\_T,\ vertex\_gradients\_T,\ edge\_gradients\_T,}}
\DoxyCodeLine{00198\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ \ initial\_vertex\_positions\_T,\ face\_vertex\_uv\_positions,}}
\DoxyCodeLine{00199\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ \ corner\_to\_corner\_uv\_positions,\ midpoint\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00200\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ \ reverse\_edge\_orientations,\ optimization\_params,\ local\_energy,}}
\DoxyCodeLine{00201\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ \ local\_derivatives,\ local\_hessian);}}
\DoxyCodeLine{00202\ \textcolor{comment}{//}}
\DoxyCodeLine{00203\ \textcolor{comment}{//\ \ //\ Convert\ values\ to\ differentiable\ variables}}
\DoxyCodeLine{00204\ \textcolor{comment}{//\ \ //\ WARNING\ Old\ method}}
\DoxyCodeLine{00205\ \textcolor{comment}{//\ \ //\ \ std::array<TwelveSplitVector3v,\ 3>\ face\_vertex\_positions,}}
\DoxyCodeLine{00206\ \textcolor{comment}{//\ \ //\ face\_edge\_gradients;\ \ \ \ \ std::array<TwelveSplitMatrix2x3v,\ 3>}}
\DoxyCodeLine{00207\ \textcolor{comment}{//\ \ //\ face\_vertex\_gradients;}}
\DoxyCodeLine{00208\ \textcolor{comment}{//\ \ //\ \ initialize\_local\_twelve\_split\_variables<TwelveSplitVar,}}
\DoxyCodeLine{00209\ \textcolor{comment}{//\ \ //\ TwelveSplitVector3v,\ TwelveSplitMatrix2x3v>(}}
\DoxyCodeLine{00210\ \textcolor{comment}{//\ \ //\ vertex\_positions\_T,\ \ \ \ \ \ vertex\_gradients\_T,}}
\DoxyCodeLine{00211\ \textcolor{comment}{//\ \ //\ edge\_gradients\_T,}}
\DoxyCodeLine{00212\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_vertex\_positions,}}
\DoxyCodeLine{00213\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_vertex\_gradients,}}
\DoxyCodeLine{00214\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_edge\_gradients}}
\DoxyCodeLine{00215\ \textcolor{comment}{//\ \ //\ \ );}}
\DoxyCodeLine{00216\ \textcolor{comment}{//\ \ //}}
\DoxyCodeLine{00217\ \textcolor{comment}{//\ \ //\ \ //\ Add\ energy\ for\ the\ current\ face\ to\ the\ total\ energy}}
\DoxyCodeLine{00218\ \textcolor{comment}{//\ \ //\ \ TwelveSplitVar\ face\_energy\ =\ triangle\_energy(}}
\DoxyCodeLine{00219\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_vertex\_positions,}}
\DoxyCodeLine{00220\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_vertex\_gradients,}}
\DoxyCodeLine{00221\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_edge\_gradients,}}
\DoxyCodeLine{00222\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ initial\_vertex\_positions\_T,}}
\DoxyCodeLine{00223\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ face\_vertex\_uv\_positions,}}
\DoxyCodeLine{00224\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ corner\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00225\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ midpoint\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00226\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ reverse\_edge\_orientations}}
\DoxyCodeLine{00227\ \textcolor{comment}{//\ \ //\ \ );}}
\DoxyCodeLine{00228\ \textcolor{comment}{//\ \ //\ \ double\ local\_energy;}}
\DoxyCodeLine{00229\ \textcolor{comment}{//\ \ //\ \ TwelveSplitGradient\ local\_derivatives;}}
\DoxyCodeLine{00230\ \textcolor{comment}{//\ \ //\ \ TwelveSplitHessian\ local\_hessian;}}
\DoxyCodeLine{00231\ \textcolor{comment}{//\ \ //\ \ local\_energy\ =\ compute\_variable\_value<TwelveSplitVar>(face\_energy);}}
\DoxyCodeLine{00232\ \textcolor{comment}{//\ \ //\ \ compute\_variable\_gradient<TwelveSplitGradient,}}
\DoxyCodeLine{00233\ \textcolor{comment}{//\ \ //\ \ TwelveSplitVar>(face\_energy,\ local\_derivatives);}}
\DoxyCodeLine{00234\ \textcolor{comment}{//\ \ //\ \ compute\_variable\_hessian<TwelveSplitHessian,\ TwelveSplitVar>(face\_energy,}}
\DoxyCodeLine{00235\ \textcolor{comment}{//\ \ //\ \ local\_hessian);}}
\DoxyCodeLine{00236\ \textcolor{comment}{//}}
\DoxyCodeLine{00237\ \textcolor{comment}{//\ \ //\ Display\ output}}
\DoxyCodeLine{00238\ \textcolor{comment}{//\ \ //\ \ \ spdlog::info("{}Local\ face\ energy\ \{\}"{},\ local\_energy);}}
\DoxyCodeLine{00239\ \textcolor{comment}{//\ \ //\ \ \ spdlog::info("{}Local\ face\ derivative\ \{\}"{},\ local\_derivatives);}}
\DoxyCodeLine{00240\ \textcolor{comment}{//\ \ //\ \ \ spdlog::info("{}Local\ face\ hessian\ \{\}"{},\ local\_hessian);}}
\DoxyCodeLine{00241\ \textcolor{comment}{//}}
\DoxyCodeLine{00242\ \textcolor{comment}{//\ \ //\ \ \ std::array<double,\ 12>\ patch\_areas;}}
\DoxyCodeLine{00243\ \textcolor{comment}{//\ \ //\ \ \ generate\_twelve\_split\_domain\_areas(uv.row(0),\ uv.row(1),\ uv.row(2),}}
\DoxyCodeLine{00244\ \textcolor{comment}{//\ \ //\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ patch\_areas);}}
\DoxyCodeLine{00245\ \textcolor{comment}{//}}
\DoxyCodeLine{00246\ \textcolor{comment}{//\ \ //\ \ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ 12;\ ++i)\ \{}}
\DoxyCodeLine{00247\ \textcolor{comment}{//\ \ //\ \ \ \ \ spdlog::info("{}Face\ patch\ areas:\ \{\}"{},\ patch\_areas[i]);}}
\DoxyCodeLine{00248\ \textcolor{comment}{//\ \ //\ \ \ \}}}
\DoxyCodeLine{00249\ \textcolor{comment}{//\}}}
\DoxyCodeLine{00250\ \textcolor{comment}{//}}
\DoxyCodeLine{00251\ \textcolor{comment}{//TEST\_CASE("{}generate\_input\_data"{},\ "{}[assemble\_hessian]"{})\ \{}}
\DoxyCodeLine{00252\ \textcolor{comment}{//\ \ spdlog::set\_level(spdlog::level::info);}}
\DoxyCodeLine{00253\ \textcolor{comment}{//}}
\DoxyCodeLine{00254\ \textcolor{comment}{//\ \ //\ Build\ affine\ manifold\ domain}}
\DoxyCodeLine{00255\ \textcolor{comment}{//\ \ Eigen::MatrixXd\ uv(3,\ 2);}}
\DoxyCodeLine{00256\ \textcolor{comment}{//\ \ Eigen::MatrixXi\ F(1,\ 3);}}
\DoxyCodeLine{00257\ \textcolor{comment}{//\ \ double\ in1,\ in2,\ in3,\ in4,\ in5,\ in6;}}
\DoxyCodeLine{00258\ \textcolor{comment}{//\ \ double\ c\_uv,\ c\_uu,\ c\_vv;}}
\DoxyCodeLine{00259\ \textcolor{comment}{//}}
\DoxyCodeLine{00260\ \textcolor{comment}{//\ \ //\ uv\ <<}}
\DoxyCodeLine{00261\ \textcolor{comment}{//\ \ //\ \ \ 1.0,\ \ 0.0,}}
\DoxyCodeLine{00262\ \textcolor{comment}{//\ \ //\ \ \ 0.0,\ \ 1.0,}}
\DoxyCodeLine{00263\ \textcolor{comment}{//\ \ //\ \ \ 0.0,\ \ 0.0;}}
\DoxyCodeLine{00264\ \textcolor{comment}{//\ \ //\ \ \ uv\ <<\ 2.0,\ 0.0,\ 0.0,\ 2.0,\ 0.0,\ 0.0;}}
\DoxyCodeLine{00265\ \textcolor{comment}{//}}
\DoxyCodeLine{00266\ \textcolor{comment}{//\ \ std::cin\ >>\ in1\ >>\ in2\ >>\ in3\ >>\ in4\ >>\ in5\ >>\ in6;}}
\DoxyCodeLine{00267\ \textcolor{comment}{//\ \ std::cin\ >>\ c\_uv\ >>\ c\_uu\ >>\ c\_vv;}}
\DoxyCodeLine{00268\ \textcolor{comment}{//\ \ uv\ <<\ in1,\ in2,\ in3,\ in4,\ in5,\ in6;}}
\DoxyCodeLine{00269\ \textcolor{comment}{//\ \ std::cout\ <<\ uv\ <<\ std::endl;}}
\DoxyCodeLine{00270\ \textcolor{comment}{//\ \ //\ \ \ uv\ <<\ 1.0,\ 0.0,\ 0.0,\ 2.0,\ 0.0,\ 0.0;}}
\DoxyCodeLine{00271\ \textcolor{comment}{//\ \ //\ \ \ uv\ <<\ 0.8,\ 0.02,\ 0.1,\ 0.85,\ 0.5,\ -\/0.05;}}
\DoxyCodeLine{00272\ \textcolor{comment}{//\ \ F\ <<\ 0,\ 1,\ 2;}}
\DoxyCodeLine{00273\ \textcolor{comment}{//}}
\DoxyCodeLine{00274\ \textcolor{comment}{//\ \ std::array<SpatialVector,\ 3>\ vertex\_positions\_T;}}
\DoxyCodeLine{00275\ \textcolor{comment}{//\ \ std::array<Matrix2x3r,\ 3>\ vertex\_gradients\_T;}}
\DoxyCodeLine{00276\ \textcolor{comment}{//\ \ std::array<SpatialVector,\ 3>\ edge\_gradients\_T;}}
\DoxyCodeLine{00277\ \textcolor{comment}{//\ \ std::array<SpatialVector,\ 3>\ initial\_vertex\_positions\_T;}}
\DoxyCodeLine{00278\ \textcolor{comment}{//\ \ std::array<PlanarPoint,\ 3>\ face\_vertex\_uv\_positions;}}
\DoxyCodeLine{00279\ \textcolor{comment}{//\ \ std::array<Matrix2x2r,\ 3>\ corner\_to\_corner\_uv\_positions;}}
\DoxyCodeLine{00280\ \textcolor{comment}{//\ \ std::array<PlanarPoint,\ 3>\ midpoint\_to\_corner\_uv\_positions;}}
\DoxyCodeLine{00281\ \textcolor{comment}{//\ \ std::array<bool,\ 3>\ reverse\_edge\_orientations;}}
\DoxyCodeLine{00282\ \textcolor{comment}{//\ \ OptimizationParameters\ optimization\_params;}}
\DoxyCodeLine{00283\ \textcolor{comment}{//\ \ optimization\_params.parametrized\_quadratic\_surface\_mapping\_factor\ =\ 1;}}
\DoxyCodeLine{00284\ \textcolor{comment}{//\ \ optimization\_params.position\_difference\_factor\ =\ 1000;}}
\DoxyCodeLine{00285\ \textcolor{comment}{//}}
\DoxyCodeLine{00286\ \textcolor{comment}{//\ \ //\ \ \ generate\_twelve\_split\_quadratic\_surface\_mapping(uv,\ F,\ 0.0,\ 0.0,}}
\DoxyCodeLine{00287\ \textcolor{comment}{//\ \ //\ \ \ 0.0);}}
\DoxyCodeLine{00288\ \textcolor{comment}{//\ \ generate\_twelve\_split\_quadratic\_surface\_mapping(}}
\DoxyCodeLine{00289\ \textcolor{comment}{//\ \ \ \ \ \ uv,\ F,\ c\_uv,\ c\_uu,\ c\_vv,\ vertex\_positions\_T,\ vertex\_gradients\_T,}}
\DoxyCodeLine{00290\ \textcolor{comment}{//\ \ \ \ \ \ edge\_gradients\_T,\ initial\_vertex\_positions\_T,\ face\_vertex\_uv\_positions,}}
\DoxyCodeLine{00291\ \textcolor{comment}{//\ \ \ \ \ \ corner\_to\_corner\_uv\_positions,\ midpoint\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00292\ \textcolor{comment}{//\ \ \ \ \ \ reverse\_edge\_orientations);}}
\DoxyCodeLine{00293\ \textcolor{comment}{//\ \ //\ \ \ generate\_twelve\_split\_quadratic\_surface\_mapping(uv,\ F,\ 0.0,\ 1.0,\ 0.0);}}
\DoxyCodeLine{00294\ \textcolor{comment}{//\ \ //\ \ \ generate\_twelve\_split\_quadratic\_surface\_mapping(uv,\ F,\ 0.0,\ 0.0,\ 1.0);}}
\DoxyCodeLine{00295\ \textcolor{comment}{//\ \ //\ \ \ generate\_twelve\_split\_quadratic\_surface\_mapping(uv,\ F,\ 1.0,\ 2.0,\ 3.0);}}
\DoxyCodeLine{00296\ \textcolor{comment}{//}}
\DoxyCodeLine{00297\ \textcolor{comment}{//\ \ Eigen::Matrix<double,\ 12,\ 3>\ r;}}
\DoxyCodeLine{00298\ \textcolor{comment}{//\ \ r.row(0)\ =\ vertex\_positions\_T[0];}}
\DoxyCodeLine{00299\ \textcolor{comment}{//\ \ r.row(1)\ =\ vertex\_positions\_T[1];}}
\DoxyCodeLine{00300\ \textcolor{comment}{//\ \ r.row(2)\ =\ vertex\_positions\_T[2];}}
\DoxyCodeLine{00301\ \textcolor{comment}{//\ \ r.row(3)\ =\ vertex\_gradients\_T[0].row(0);}}
\DoxyCodeLine{00302\ \textcolor{comment}{//\ \ r.row(4)\ =\ vertex\_gradients\_T[0].row(1);}}
\DoxyCodeLine{00303\ \textcolor{comment}{//\ \ r.row(5)\ =\ vertex\_gradients\_T[1].row(0);}}
\DoxyCodeLine{00304\ \textcolor{comment}{//\ \ r.row(6)\ =\ vertex\_gradients\_T[1].row(1);}}
\DoxyCodeLine{00305\ \textcolor{comment}{//\ \ r.row(7)\ =\ vertex\_gradients\_T[2].row(0);}}
\DoxyCodeLine{00306\ \textcolor{comment}{//\ \ r.row(8)\ =\ vertex\_gradients\_T[2].row(1);}}
\DoxyCodeLine{00307\ \textcolor{comment}{//\ \ r.row(9)\ =\ edge\_gradients\_T[0];}}
\DoxyCodeLine{00308\ \textcolor{comment}{//\ \ r.row(10)\ =\ edge\_gradients\_T[1];}}
\DoxyCodeLine{00309\ \textcolor{comment}{//\ \ r.row(11)\ =\ edge\_gradients\_T[2];}}
\DoxyCodeLine{00310\ \textcolor{comment}{//}}
\DoxyCodeLine{00311\ \textcolor{comment}{//\ \ Eigen::Matrix<double,\ 3,\ 2>\ uv\_p;}}
\DoxyCodeLine{00312\ \textcolor{comment}{//\ \ uv\_p.row(0)\ =\ face\_vertex\_uv\_positions[0];}}
\DoxyCodeLine{00313\ \textcolor{comment}{//\ \ uv\_p.row(1)\ =\ face\_vertex\_uv\_positions[1];}}
\DoxyCodeLine{00314\ \textcolor{comment}{//\ \ uv\_p.row(2)\ =\ face\_vertex\_uv\_positions[2];}}
\DoxyCodeLine{00315\ \textcolor{comment}{//}}
\DoxyCodeLine{00316\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}uv\_p:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00317\ \textcolor{comment}{//\ \ std::cout\ <<\ uv\_p\ <<\ std::endl;}}
\DoxyCodeLine{00318\ \textcolor{comment}{//}}
\DoxyCodeLine{00319\ \textcolor{comment}{//\ \ auto\ C\_gl\ =\ get\_C\_gl(uv\_p,\ corner\_to\_corner\_uv\_positions,\ reverse\_edge\_orientations);}}
\DoxyCodeLine{00320\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}C\_gl:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00321\ \textcolor{comment}{//\ \ std::cout\ <<\ C\_gl\ <<\ std::endl\ <<\ std::endl;}}
\DoxyCodeLine{00322\ \textcolor{comment}{//}}
\DoxyCodeLine{00323\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}C\_gl\ *\ r:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00324\ \textcolor{comment}{//\ \ std::cout\ <<\ C\_gl\ *\ r\ <<\ std::endl\ <<\ std::endl;}}
\DoxyCodeLine{00325\ \textcolor{comment}{//}}
\DoxyCodeLine{00326\ \textcolor{comment}{//\ \ auto\ Tquad\_Cder\_Csub\ =\ get\_Tquad\_Cder\_Csub();}}
\DoxyCodeLine{00327\ \textcolor{comment}{//}}
\DoxyCodeLine{00328\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}Tquad\_Cder\_Csub\ *\ C\_gl\ *\ r:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00329\ \textcolor{comment}{//\ \ std::cout\ <<\ Tquad\_Cder\_Csub\ *\ C\_gl\ *\ r\ <<\ std::endl\ <<\ std::endl;}}
\DoxyCodeLine{00330\ \textcolor{comment}{//}}
\DoxyCodeLine{00331\ \textcolor{comment}{//\ \ auto\ R\_quad\ =\ get\_R\_quad(uv\_p);}}
\DoxyCodeLine{00332\ \textcolor{comment}{//}}
\DoxyCodeLine{00333\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}R\_quad:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00334\ \textcolor{comment}{//\ \ std::cout\ <<\ R\_quad\ <<\ std::endl\ <<\ std::endl;}}
\DoxyCodeLine{00335\ \textcolor{comment}{//}}
\DoxyCodeLine{00336\ \textcolor{comment}{//\ \ auto\ S\ =\ get\_S(uv\_p);}}
\DoxyCodeLine{00337\ \textcolor{comment}{//}}
\DoxyCodeLine{00338\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}S:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00339\ \textcolor{comment}{//\ \ std::cout\ <<\ S\ <<\ std::endl\ <<\ std::endl;}}
\DoxyCodeLine{00340\ \textcolor{comment}{//}}
\DoxyCodeLine{00341\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}G\ *\ r:"{}\ <<\ std::endl;}}
\DoxyCodeLine{00342\ \textcolor{comment}{//\ \ std::cout\ <<\ R\_quad\ *\ Tquad\_Cder\_Csub\ *\ C\_gl\ *\ r\ <<\ std::endl\ <<\ std::endl;}}
\DoxyCodeLine{00343\ \textcolor{comment}{//}}
\DoxyCodeLine{00344\ \textcolor{comment}{//\ \ //\ autodiff}}
\DoxyCodeLine{00345\ \textcolor{comment}{//\ \ TwelveSplitGradient\ local\_derivatives\_autodiff;}}
\DoxyCodeLine{00346\ \textcolor{comment}{//\ \ TwelveSplitHessian\ local\_hessian\_autodiff;}}
\DoxyCodeLine{00347\ \textcolor{comment}{//\ \ double\ local\_energy\_autodiff;}}
\DoxyCodeLine{00348\ \textcolor{comment}{//}}
\DoxyCodeLine{00349\ \textcolor{comment}{//\ \ compute\_local\_twelve\_split\_energy\_quadratic(}}
\DoxyCodeLine{00350\ \textcolor{comment}{//\ \ \ \ \ \ vertex\_positions\_T,\ vertex\_gradients\_T,\ edge\_gradients\_T,}}
\DoxyCodeLine{00351\ \textcolor{comment}{//\ \ \ \ \ \ initial\_vertex\_positions\_T,\ face\_vertex\_uv\_positions,}}
\DoxyCodeLine{00352\ \textcolor{comment}{//\ \ \ \ \ \ corner\_to\_corner\_uv\_positions,\ midpoint\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00353\ \textcolor{comment}{//\ \ \ \ \ \ reverse\_edge\_orientations,\ optimization\_params,\ local\_energy\_autodiff,}}
\DoxyCodeLine{00354\ \textcolor{comment}{//\ \ \ \ \ \ local\_derivatives\_autodiff,\ local\_hessian\_autodiff);}}
\DoxyCodeLine{00355\ \textcolor{comment}{//}}
\DoxyCodeLine{00356\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}energy\ autodiff:\ "{}\ <<\ local\_energy\_autodiff\ <<\ std::endl}}
\DoxyCodeLine{00357\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00358\ \textcolor{comment}{//}}
\DoxyCodeLine{00359\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}derivative\ autodiff:\ "{}\ <<\ std::endl}}
\DoxyCodeLine{00360\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ local\_derivatives\_autodiff\ <<\ std::endl}}
\DoxyCodeLine{00361\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00362\ \textcolor{comment}{//}}
\DoxyCodeLine{00363\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}hessian\ autodiff:\ "{}\ <<\ std::endl}}
\DoxyCodeLine{00364\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ local\_hessian\_autodiff\ <<\ std::endl}}
\DoxyCodeLine{00365\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00366\ \textcolor{comment}{//}}
\DoxyCodeLine{00367\ \textcolor{comment}{//\ \ //\ assemble}}
\DoxyCodeLine{00368\ \textcolor{comment}{//\ \ TwelveSplitGradient\ local\_derivatives\_assemble;}}
\DoxyCodeLine{00369\ \textcolor{comment}{//\ \ TwelveSplitHessian\ local\_hessian\_assemble;}}
\DoxyCodeLine{00370\ \textcolor{comment}{//\ \ double\ local\_energy\_assemble;}}
\DoxyCodeLine{00371\ \textcolor{comment}{//}}
\DoxyCodeLine{00372\ \textcolor{comment}{//\ \ std::array<bool,\ 3>\ is\_cone\ =\ \{false,\ false,\ false\};}}
\DoxyCodeLine{00373\ \textcolor{comment}{//\ \ std::array<bool,\ 3>\ is\_cone\_adjacent\ =\ \{false,\ false,\ false\};}}
\DoxyCodeLine{00374\ \textcolor{comment}{//\ \ SpatialVector\ normal;}}
\DoxyCodeLine{00375\ \textcolor{comment}{//\ \ normal.setZero();}}
\DoxyCodeLine{00376\ \textcolor{comment}{//\ \ compute\_local\_twelve\_split\_energy\_quadratic\_manually(}}
\DoxyCodeLine{00377\ \textcolor{comment}{//\ \ \ \ \ \ vertex\_positions\_T,\ vertex\_gradients\_T,\ edge\_gradients\_T,}}
\DoxyCodeLine{00378\ \textcolor{comment}{//\ \ \ \ \ \ initial\_vertex\_positions\_T,\ face\_vertex\_uv\_positions,\ corner\_to\_corner\_uv\_positions,}}
\DoxyCodeLine{00379\ \textcolor{comment}{//\ \ \ \ \ \ reverse\_edge\_orientations,\ is\_cone,\ is\_cone\_adjacent,\ normal,\ optimization\_params,\ local\_energy\_assemble,}}
\DoxyCodeLine{00380\ \textcolor{comment}{//\ \ \ \ \ \ local\_derivatives\_assemble,\ local\_hessian\_assemble);}}
\DoxyCodeLine{00381\ \textcolor{comment}{//}}
\DoxyCodeLine{00382\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}energy\ mine:\ "{}\ <<\ local\_energy\_assemble\ <<\ std::endl}}
\DoxyCodeLine{00383\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00384\ \textcolor{comment}{//}}
\DoxyCodeLine{00385\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}derivative\ mine:\ "{}\ <<\ std::endl}}
\DoxyCodeLine{00386\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ local\_derivatives\_assemble\ <<\ std::endl}}
\DoxyCodeLine{00387\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00388\ \textcolor{comment}{//}}
\DoxyCodeLine{00389\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}hessian\ mine:\ "{}\ <<\ std::endl}}
\DoxyCodeLine{00390\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ local\_hessian\_assemble\ <<\ std::endl}}
\DoxyCodeLine{00391\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00392\ \textcolor{comment}{//}}
\DoxyCodeLine{00393\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}energy\ diff:\ "{}}}
\DoxyCodeLine{00394\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ abs(local\_energy\_autodiff\ -\/\ local\_energy\_assemble)\ <<\ std::endl;}}
\DoxyCodeLine{00395\ \textcolor{comment}{//}}
\DoxyCodeLine{00396\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}derivatives\ norm\ diff:\ "{}}}
\DoxyCodeLine{00397\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ (local\_derivatives\_autodiff\ -\/\ local\_derivatives\_assemble).norm()}}
\DoxyCodeLine{00398\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00399\ \textcolor{comment}{//}}
\DoxyCodeLine{00400\ \textcolor{comment}{//\ \ std::cout\ <<\ "{}hessian\ norm\ diff:\ "{}}}
\DoxyCodeLine{00401\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ (local\_hessian\_autodiff\ -\/\ local\_hessian\_assemble).norm()}}
\DoxyCodeLine{00402\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ <<\ std::endl;}}
\DoxyCodeLine{00403\ \textcolor{comment}{//\}}}

\end{DoxyCode}
